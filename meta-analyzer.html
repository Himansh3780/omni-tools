<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro SERP Simulator - OmniTools</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --bg: #0f172a; --panel: #1e293b; --text: #f8fafc; --muted: #94a3b8; --border: #334155; --google-blue: #1a0dab; }
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        
        /* INPUT AREA */
        .card { background: var(--panel); padding: 30px; border-radius: 16px; border: 1px solid var(--border); margin-bottom: 30px; }
        label { display: block; margin-bottom: 8px; color: var(--muted); font-weight: 700; font-size: 0.85rem; text-transform: uppercase; }
        input, textarea { width: 100%; padding: 12px; background: #020617; border: 1px solid var(--border); color: white; border-radius: 8px; margin-bottom: 5px; font-family: sans-serif; }
        input:focus, textarea:focus { border-color: #3b82f6; }

        /* PIXEL BAR */
        .progress-container { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; font-size: 0.8rem; color: var(--muted); }
        .progress-track { flex: 1; height: 6px; background: #334155; border-radius: 4px; margin: 0 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: #22c55e; width: 0%; transition: 0.3s; }
        .progress-fill.warning { background: #eab308; }
        .progress-fill.danger { background: #ef4444; }

        /* GOOGLE PREVIEW BOX */
        .preview-wrapper { background: white; padding: 20px; border-radius: 12px; color: #3c4043; font-family: arial, sans-serif; }
        
        /* Desktop View */
        .view-desktop .g-cite { color: #202124; font-size: 14px; line-height: 1.3; }
        .view-desktop .g-link { color: #1a0dab; font-size: 20px; line-height: 1.3; text-decoration: none; cursor: pointer; display: inline-block; }
        .view-desktop .g-link:hover { text-decoration: underline; }
        .view-desktop .g-desc { color: #4d5156; font-size: 14px; line-height: 1.58; margin-top: 3px; max-width: 600px; }
        
        /* Mobile View Modifier */
        .view-mobile .g-link { color: #1558d6; font-size: 18px; } /* Mobile titles are blue-r and smaller */
        
        /* VIEW TOGGLE */
        .toggle-row { display: flex; justify-content: flex-end; margin-bottom: 10px; gap: 10px; }
        .view-btn { background: var(--panel); border: 1px solid var(--border); color: var(--muted); padding: 8px 15px; border-radius: 20px; cursor: pointer; font-size: 0.8rem; font-weight: 600; }
        .view-btn.active { background: #3b82f6; color: white; border-color: #3b82f6; }
        .view-btn i { margin-right: 5px; }

        .keyword-bold { font-weight: bold; color: #4d5156; }
    </style>
</head>
<body>

<div class="container">
    <a href="index.html" style="color:#94a3b8; text-decoration:none; margin-bottom:20px; display:inline-block;"><i class="fa-solid fa-arrow-left"></i> Back</a>
    
    <div class="card">
        <label>Focus Keyword (Optional)</label>
        <input type="text" id="keyword" placeholder="e.g. best pizza" oninput="update()">
        <p style="color:#64748b; font-size:0.8rem; margin-bottom:20px;">We will bold this keyword in the preview, just like Google.</p>

        <label>Page Title</label>
        <input type="text" id="title" placeholder="My Awesome Page Title" oninput="update()">
        <div class="progress-container">
            <span id="pixelVal">0px</span>
            <div class="progress-track"><div class="progress-fill" id="pixelBar"></div></div>
            <span>Max 580px</span>
        </div>

        <label>Meta Description</label>
        <textarea id="desc" rows="3" placeholder="Click here to read more about..." oninput="update()"></textarea>
        <div class="progress-container">
            <span id="charVal">0 chars</span>
            <div class="progress-track"><div class="progress-fill" id="charBar"></div></div>
            <span>Max 160 chars</span>
        </div>
    </div>

    <div class="toggle-row">
        <button class="view-btn active" onclick="setView('desktop')" id="btnDesk"><i class="fa-solid fa-desktop"></i> Desktop</button>
        <button class="view-btn" onclick="setView('mobile')" id="btnMob"><i class="fa-solid fa-mobile-screen"></i> Mobile</button>
    </div>

    <div class="preview-wrapper view-desktop" id="previewBox">
        <div class="g-cite">
            <span style="background:#f1f3f4; border-radius:50%; width:26px; height:26px; display:inline-flex; align-items:center; justify-content:center; margin-right:8px; vertical-align:middle;">
                <i class="fa-brands fa-google" style="font-size:14px;"></i>
            </span>
            <span style="vertical-align:middle;">
                yoursite.com <span style="color:#5f6368">› article › category</span>
            </span>
        </div>
        <a class="g-link" id="gTitle">My Awesome Page Title</a>
        <div class="g-desc" id="gDesc">Click here to read more about...</div>
    </div>
</div>

<script>
    // Canvas for measuring text width in pixels (Accurate Google Simulation)
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    ctx.font = '20px arial'; // Google's Desktop Title Font

    function update() {
        const title = document.getElementById('title').value || "My Awesome Page Title";
        const desc = document.getElementById('desc').value || "Click here to read more about...";
        const keyword = document.getElementById('keyword').value;

        // 1. CALCULATE PIXELS (Title)
        const width = ctx.measureText(title).width;
        const maxPx = 580; // Google's safe width
        const pct = Math.min((width / maxPx) * 100, 100);
        
        document.getElementById('pixelVal').innerText = Math.round(width) + "px";
        const pBar = document.getElementById('pixelBar');
        pBar.style.width = pct + "%";
        
        // Color Logic
        pBar.className = 'progress-fill';
        if(width > 580) pBar.classList.add('danger');
        else if(width > 500) pBar.classList.add('warning');

        // 2. META DESC (Characters)
        const chars = desc.length;
        const maxChar = 160;
        const charPct = Math.min((chars / maxChar) * 100, 100);
        document.getElementById('charVal').innerText = chars + " chars";
        document.getElementById('charBar').style.width = charPct + "%";
        if(chars > 160) document.getElementById('charBar').classList.add('danger');

        // 3. RENDER & TRUNCATE
        // If pixels > 580, we must cut off the text with "..."
        let displayTitle = title;
        if(width > maxPx) {
            // Simple truncation approximation logic for preview
            const cutRatio = maxPx / width;
            const cutLen = Math.floor(title.length * cutRatio) - 3;
            displayTitle = title.substring(0, cutLen) + "...";
        }

        document.getElementById('gTitle').innerText = displayTitle;

        // 4. BOLD KEYWORDS
        let displayDesc = desc;
        if(chars > 160) displayDesc = desc.substring(0, 157) + "...";
        
        if(keyword) {
            // Regex to wrap keyword in <b>
            const reg = new RegExp(`(${keyword})`, 'gi');
            displayDesc = displayDesc.replace(reg, '<span class="keyword-bold">$1</span>');
        }
        document.getElementById('gDesc').innerHTML = displayDesc;
    }

    function setView(mode) {
        const box = document.getElementById('previewBox');
        document.getElementById('btnDesk').classList.toggle('active', mode === 'desktop');
        document.getElementById('btnMob').classList.toggle('active', mode === 'mobile');
        
        if(mode === 'mobile') {
            box.className = 'preview-wrapper view-mobile';
            ctx.font = '18px arial'; // Resize font measurement for mobile
        } else {
            box.className = 'preview-wrapper view-desktop';
            ctx.font = '20px arial';
        }
        update();
    }
</script>
</body>
</html>